<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æœ«æ—¥æº–å‚™è€…ï¼šé¿é›£åŒ…å¤§æŒ‘æˆ°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .item-card {
            transition: all 0.2s;
        }
        .item-card:hover {
            transform: translateY(-2px);
        }
        .item-card.selected {
            background-color: #3b82f6;
            color: white;
        }
        .item-card.disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        .fade-in {
            animation: fadeIn 0.5s;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-100 min-h-screen">
    <div id="game-container" class="container mx-auto px-4 py-8 max-w-4xl">
        <!-- ç¬¬ä¸€éšæ®µï¼šè¶…å¸‚ç±Œå‚™ -->
        <div id="phase1" class="fade-in">
            <h1 class="text-4xl font-bold text-center mb-8 text-yellow-400">æœ«æ—¥æº–å‚™è€…ï¼šé¿é›£åŒ…å¤§æŒ‘æˆ°</h1>
            
            <div class="bg-gray-800 rounded-lg p-6 mb-6 shadow-lg">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-2xl font-semibold">è¶…å¸‚ç±Œå‚™éšæ®µ</h2>
                    <div class="text-xl space-y-1">
                        <div>
                            <span class="text-gray-400">å‰©é¤˜è³‡é‡‘ï¼š</span>
                            <span id="budget" class="text-yellow-400 font-bold">$4000</span>
                        </div>
                        <div>
                            <span class="text-gray-400">ç¸½è² é‡ï¼š</span>
                            <span id="total-weight" class="font-bold">0</span>
                            <span class="text-gray-400 text-sm">kg</span>
                            <span id="weight-warning" class="text-red-400 text-sm ml-2 hidden">âš ï¸ è² é‡éé«˜ï¼</span>
                        </div>
                    </div>
                </div>
                <p class="text-gray-300 mb-4">ä½ æœ‰ $10000 çš„é ç®—ï¼Œè«‹é¸æ“‡å¿…è¦çš„é¿é›£ç‰©å“ã€‚æ³¨æ„ï¼šç‰©å“é«”ç©å¤§ï¼Œå¸¶å¤ªå¤šæœƒé™ä½ç§»å‹•é€Ÿåº¦ï¼</p>
            </div>

            <div class="bg-gray-800 rounded-lg p-6 mb-6 shadow-lg">
                <h3 class="text-xl font-semibold mb-4">å¯é¸ç‰©å“</h3>
                <div class="mb-4">
                    <h4 class="text-lg font-semibold text-yellow-400 mb-2">ğŸŸ¡ éš¨èº«é¡ï¼ˆé«”ç©å°ï¼Œæ±ºå®šå‰24å°æ™‚å­˜æ´»ç‡ï¼‰</h4>
                    <div id="portable-items" class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                        <!-- éš¨èº«é¡ç‰©å“å°‡ç”± JavaScript å‹•æ…‹ç”Ÿæˆ -->
                    </div>
                </div>
                <div class="mb-4">
                    <h4 class="text-lg font-semibold text-green-400 mb-2">ğŸŸ¢ èº«åˆ†è­‰ä»¶</h4>
                    <div id="document-items" class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                        <!-- èº«åˆ†è­‰ä»¶å°‡ç”± JavaScript å‹•æ…‹ç”Ÿæˆ -->
                    </div>
                </div>
                <div>
                    <h4 class="text-lg font-semibold text-red-400 mb-2">ğŸ”´ å±…å®¶å„²å‚™é¡</h4>
                    <div id="home-items" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <!-- å±…å®¶å„²å‚™é¡ç‰©å“å°‡ç”± JavaScript å‹•æ…‹ç”Ÿæˆ -->
                    </div>
                </div>
            </div>

            <div class="bg-gray-800 rounded-lg p-6 mb-6 shadow-lg">
                <h3 class="text-xl font-semibold mb-4">é¿é›£åŒ…æ¸…å–®</h3>
                <div id="backpack-list" class="min-h-[100px]">
                    <p class="text-gray-400 italic">å°šæœªé¸æ“‡ä»»ä½•ç‰©å“</p>
                </div>
                <div class="mt-4 pt-4 border-t border-gray-700">
                    <div class="flex justify-between items-center">
                        <span class="text-lg">ç¸½èŠ±è²»ï¼š</span>
                        <span id="total-cost" class="text-xl font-bold text-yellow-400">$0</span>
                    </div>
                </div>
            </div>

            <button id="start-btn" class="w-full bg-green-600 hover:bg-green-700 disabled:bg-gray-600 disabled:cursor-not-allowed text-white font-bold py-3 px-6 rounded-lg transition-colors shadow-lg">
                æº–å‚™å¥½äº†ï¼Œå‡ºç™¼ï¼
            </button>
        </div>

        <!-- ç¬¬äºŒéšæ®µï¼šç½é›£ç™¼ç”Ÿèˆ‡ç”Ÿå­˜æ¨¡æ“¬ -->
        <div id="phase2" class="hidden fade-in">
            <h1 class="text-4xl font-bold text-center mb-8 text-red-400">ç½é›£ç™¼ç”Ÿ</h1>
            
            <div class="bg-gray-800 rounded-lg p-6 mb-6 shadow-lg">
                <p class="text-lg mb-4">å¼·çƒˆåœ°éœ‡è¥²ä¾†ï¼å»ºç¯‰ç‰©åŠ‡çƒˆæ–æ™ƒï¼Œåœé›»ã€æ‰è½ç‰©å››è™•é£›æ•£ã€‚ä½ å¿…é ˆç«‹å³é€ƒé›¢ï¼Œè€Œä½ çš„é¿é›£åŒ…å°‡æ±ºå®šä½ çš„å‘½é‹...</p>
            </div>

            <div id="survival-checks" class="space-y-4 mb-6">
                <!-- ç”Ÿå­˜åˆ¤å®šçµæœå°‡é¡¯ç¤ºåœ¨é€™è£¡ -->
            </div>

            <div id="final-result" class="bg-gray-800 rounded-lg p-6 shadow-lg hidden">
                <!-- æœ€çµ‚çµå±€å°‡é¡¯ç¤ºåœ¨é€™è£¡ -->
            </div>

            <button id="replay-btn" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg transition-colors shadow-lg mt-6 hidden">
                é‡æ–°é–‹å§‹
            </button>
        </div>
    </div>

    <script>
        // éŠæˆ²ç‹€æ…‹
        let budget = 10000;
        let selectedItems = [];
        let totalCost = 0;
        let totalWeight = 0;

        // ç‰©å“æ¸…å–®ï¼ˆåŒ…å«è² é‡å€¼å’Œåˆ†é¡ï¼‰
        // category: 'portable'=éš¨èº«é¡, 'home'=å±…å®¶å„²å‚™é¡, 'document'=èº«åˆ†è­‰ä»¶
        const items = [
            // éš¨èº«é¡ç‰©å“ï¼ˆé«”ç©å°ï¼Œæ±ºå®šå‰24å°æ™‚å­˜æ´»ç‡ï¼‰
            { id: 'helmet', name: 'é ­ç›”ï¼ˆæŠ˜ç–Šå¼ï¼‰', price: 350, weight: 2, category: 'portable', phase: 'emergency' },
            { id: 'headlamp', name: 'é ­ç‡ˆ', price: 200, weight: 1, category: 'portable', phase: 'emergency' },
            { id: 'whistle', name: 'æ•‘é›£å“¨', price: 50, weight: 0.1, category: 'portable', phase: 'emergency' },
            { id: 'powerbank', name: 'è¡Œå‹•é›»æºï¼ˆä¹¾é›»æ± å‹ï¼‰', price: 400, weight: 1.5, category: 'portable', phase: 'emergency' },
            { id: 'portable_toilet', name: 'æ”œå¸¶å¼å»æ‰€', price: 300, weight: 2, category: 'portable', phase: 'emergency' },
            { id: 'water_500ml', name: 'æ°´ï¼ˆ500ml x2ï¼‰', price: 100, weight: 1.5, category: 'portable', phase: 'emergency' },
            { id: 'raincoat', name: 'é›¨è¡£', price: 150, weight: 0.5, category: 'portable', phase: 'emergency' },
            { id: 'towel', name: 'æ¯›å·¾', price: 80, weight: 0.3, category: 'portable', phase: 'emergency' },
            { id: 'mask', name: 'å£ç½©', price: 50, weight: 0.1, category: 'portable', phase: 'emergency' },
            { id: 'jelly_drink', name: 'æœå‡é£²æ–™', price: 120, weight: 0.5, category: 'portable', phase: 'emergency' },
            { id: 'firstaid', name: 'æ€¥æ•‘ç”¨å“', price: 400, weight: 1, category: 'portable', phase: 'emergency' },
            { id: 'water_bag', name: 'å„²æ°´è¢‹', price: 200, weight: 0.5, category: 'portable', phase: 'emergency' },
            { id: 'batteries', name: 'ä¹¾é›»æ± ', price: 100, weight: 0.3, category: 'portable', phase: 'emergency' },
            { id: 'life_straw', name: 'ç”Ÿå‘½å¸ç®¡', price: 450, weight: 0.12, category: 'portable', phase: 'emergency' },
            { id: 'emergency_rations', name: 'æˆ°å‚™ä¹¾ç³§ï¼ˆ3æ—¥ä»½ï¼‰', price: 650, weight: 0.9, category: 'portable', phase: 'emergency' },
            { id: 'radio', name: 'æ”¶éŸ³æ©Ÿ', price: 610, weight: 0.5, category: 'portable', phase: 'emergency' },
            { id: 'flashlight_aa', name: 'æ‰‹é›»ç­’ï¼ˆAAé›»æ± ï¼‰', price: 750, weight: 0.15, category: 'portable', phase: 'emergency' },
            { id: 'gloves', name: 'å·¥ä½œæ‰‹å¥—', price: 140, weight: 0.2, category: 'portable', phase: 'emergency' },
            { id: 'helmet_standard', name: 'å®‰å…¨é ­ç›”', price: 800, weight: 0.5, category: 'portable', phase: 'emergency' },
            { id: 'walkie_talkie', name: 'å°è¬›æ©Ÿ', price: 400, weight: 0.3, category: 'portable', phase: 'emergency' },
            { id: 'emergency_blanket', name: 'é‹ç®”é¿é›£æ¯¯', price: 75, weight: 0.3, category: 'portable', phase: 'emergency' },
            { id: 'steel_cup', name: 'é‹¼æ¯', price: 120, weight: 0.4, category: 'portable', phase: 'emergency' },
            { id: 'cash', name: 'å°é¡ç¾é‡‘', price: 1000, weight: 0.1, category: 'portable', phase: 'emergency' },
            { id: 'toilet_paper', name: 'è¡›ç”Ÿç´™', price: 80, weight: 0.3, category: 'portable', phase: 'emergency' },
            { id: 'sanitary_pads', name: 'è¡›ç”Ÿæ£‰', price: 100, weight: 0.2, category: 'portable', phase: 'emergency' },
            { id: 'thermometer', name: 'é«”æº«è¨ˆ', price: 150, weight: 0.05, category: 'portable', phase: 'emergency' },
            { id: 'alcohol_cotton', name: 'é…’ç²¾ã€æ£‰ç‰‡', price: 100, weight: 0.2, category: 'portable', phase: 'emergency' },
            { id: 'saline', name: 'ç”Ÿç†é£Ÿé¹½æ°´', price: 70, weight: 0.3, category: 'portable', phase: 'emergency' },
            { id: 'bandage_kit', name: 'ç´—å¸ƒã€å½ˆæ€§ç¹ƒå¸¶çµ„', price: 150, weight: 0.3, category: 'portable', phase: 'emergency' },
            { id: 'tourniquet', name: 'æ­¢è¡€å¸¶', price: 200, weight: 0.2, category: 'portable', phase: 'emergency' },
            { id: 'topical_ointment', name: 'å¤–ç”¨è—¥è†çµ„ï¼ˆç™½è—¥æ°´ã€ç‡™å‚·è†ã€é˜²èšŠæ¶²ï¼‰', price: 200, weight: 0.05, category: 'portable', phase: 'emergency' },
            { id: 'anxiety_med', name: 'æŠ—ç„¦æ…®è—¥ç‰©', price: 100, weight: 0.01, category: 'portable', phase: 'emergency' },
            { id: 'pain_reliever', name: 'æ­¢ç—›é€€ç‡’è—¥ï¼ˆæ™®æ‹¿ç–¼ï¼‰', price: 80, weight: 0.05, category: 'portable', phase: 'emergency' },
            { id: 'stomach_med', name: 'è…¸èƒƒè—¥ï¼ˆæ­¢ç€‰ã€èƒƒè—¥ï¼‰', price: 100, weight: 0.05, category: 'portable', phase: 'emergency' },
            { id: 'cold_med', name: 'æ„Ÿå†’è—¥ï¼ˆæ­¢å’³åŒ–ç—°ï¼‰', price: 90, weight: 0.05, category: 'portable', phase: 'emergency' },
            { id: 'foldable_water_bag', name: 'æ‘ºç–Šæ°´è¢‹ï¼ˆ5Lï¼‰', price: 105, weight: 0.2, category: 'portable', phase: 'emergency' },
            { id: 'hand_warmers', name: 'æš–æš–åŒ…', price: 50, weight: 0.1, category: 'portable', phase: 'emergency' },
            { id: 'water_purification', name: 'æ·¨æ°´éŒ ', price: 80, weight: 0.1, category: 'portable', phase: 'emergency' },
            { id: 'pepper_spray', name: 'è¾£æ¤’æ°´ï¼ˆé‘°åŒ™åœˆå‹ï¼‰', price: 550, weight: 0.1, category: 'portable', phase: 'emergency' },
            { id: 'urine_coagulant', name: 'å°¿æ¶²å‡å›ºåŠ‘', price: 100, weight: 0.2, category: 'portable', phase: 'emergency' },
            // ç„¡é—œç·Šè¦çš„ç‰©å“ï¼ˆæ··åœ¨éš¨èº«é¡ä¸­ï¼‰
            { id: 'novel', name: 'å°èªª', price: 150, weight: 0.5, category: 'portable', phase: 'emergency', isUseless: true },
            { id: 'makeup_kit', name: 'åŒ–å¦å“çµ„', price: 500, weight: 1.2, category: 'portable', phase: 'emergency', isUseless: true },
            { id: 'portable_speaker', name: 'è—ç‰™å–‡å­', price: 350, weight: 0.8, category: 'portable', phase: 'emergency', isUseless: true },
            
            // èº«åˆ†è­‰ä»¶
            { id: 'idcopy', name: 'å½±å°èº«åˆ†è­‰', price: 10, weight: 0.1, category: 'document', phase: 'emergency' },
            
            // å±…å®¶å„²å‚™é¡ï¼ˆé«”ç©å¤§ï¼Œå¸¶å¤ªå¤šæœƒé™ä½ç§»å‹•é€Ÿåº¦ï¼‰
            { id: 'longterm_food', name: 'é•·æœŸä¿å­˜é£Ÿå“ï¼ˆ1é€±ä»½ï¼‰', price: 800, weight: 8, category: 'home', phase: 'shelter' },
            { id: 'gas_stove', name: 'å¡å¼çˆ', price: 350, weight: 3, category: 'home', phase: 'shelter' },
            { id: 'gas_canister', name: 'ç“¦æ–¯ç½', price: 150, weight: 1.5, category: 'home', phase: 'shelter' },
            { id: 'wet_wipes', name: 'æ¿•ç´™å·¾', price: 100, weight: 2, category: 'home', phase: 'shelter' },
            { id: 'mouthwash', name: 'æ¼±å£æ°´', price: 120, weight: 0.8, category: 'home', phase: 'shelter' },
            { id: 'eye_mask', name: 'çœ¼ç½©', price: 80, weight: 0.1, category: 'home', phase: 'shelter' },
            { id: 'earplugs', name: 'è€³å¡', price: 60, weight: 0.1, category: 'home', phase: 'shelter' },
            { id: 'drinks_week', name: 'é£²æ–™ï¼ˆ1é€±ä»½ï¼‰', price: 500, weight: 6, category: 'home', phase: 'shelter' },
            // ç„¡é—œç·Šè¦çš„ç‰©å“ï¼ˆæ··åœ¨å±…å®¶å„²å‚™é¡ä¸­ï¼‰
            { id: 'decorative_light', name: 'è£é£¾LEDç‡ˆä¸²', price: 250, weight: 1.5, category: 'home', phase: 'shelter', isUseless: true },
            { id: 'board_game', name: 'æ¡ŒéŠ', price: 400, weight: 2.5, category: 'home', phase: 'shelter', isUseless: true },
            { id: 'fancy_cutlery', name: 'ç²¾ç¾é¤å…·çµ„', price: 300, weight: 1.8, category: 'home', phase: 'shelter', isUseless: true },
            { id: 'scented_candle', name: 'é¦™æ°›è Ÿç‡­', price: 180, weight: 0.8, category: 'home', phase: 'shelter', isUseless: true },
            { id: 'fancy_blanket', name: 'é«˜ç´šæ¯›æ¯¯', price: 600, weight: 3, category: 'home', phase: 'shelter', isUseless: true }
        ];

        // åˆå§‹åŒ–
        function init() {
            renderItems();
            updateUI();
            
            document.getElementById('start-btn').addEventListener('click', startPhase2);
            document.getElementById('replay-btn').addEventListener('click', replay);
        }

        // æ¸²æŸ“ç‰©å“æ¸…å–®
        function renderItems() {
            const portableList = document.getElementById('portable-items');
            const documentList = document.getElementById('document-items');
            const homeList = document.getElementById('home-items');
            portableList.innerHTML = '';
            documentList.innerHTML = '';
            homeList.innerHTML = '';
            
            items.forEach(item => {
                const isSelected = selectedItems.includes(item.id);
                const canAfford = budget >= item.price;
                
                const itemCard = document.createElement('div');
                itemCard.className = `item-card bg-gray-700 rounded-lg p-4 cursor-pointer ${isSelected ? 'selected' : ''} ${!canAfford && !isSelected ? 'disabled' : ''}`;
                itemCard.innerHTML = `
                    <div class="flex justify-between items-center">
                        <div>
                            <h4 class="font-semibold">${item.name}</h4>
                            <p class="text-sm text-gray-400 mt-1">
                                $${item.price} 
                                <span class="text-blue-400">â€¢ ${item.weight}kg</span>
                            </p>
                        </div>
                        ${isSelected ? '<span class="text-green-400">âœ“ å·²é¸</span>' : ''}
                    </div>
                `;
                
                if (canAfford || isSelected) {
                    itemCard.addEventListener('click', () => toggleItem(item));
                }
                
                if (item.category === 'portable') {
                    portableList.appendChild(itemCard);
                } else if (item.category === 'document') {
                    documentList.appendChild(itemCard);
                } else if (item.category === 'home') {
                    homeList.appendChild(itemCard);
                }
            });
        }

        // åˆ‡æ›ç‰©å“é¸æ“‡
        function toggleItem(item) {
            const index = selectedItems.indexOf(item.id);
            
            if (index > -1) {
                // ç§»é™¤ç‰©å“
                selectedItems.splice(index, 1);
                totalCost -= item.price;
                // åªæœ‰éå±…å®¶å„²å‚™é¡çš„ç‰©å“æ‰è¨ˆç®—è² é‡
                if (item.category !== 'home') {
                    totalWeight -= item.weight;
                }
                budget += item.price;
            } else {
                // æ·»åŠ ç‰©å“
                if (budget >= item.price) {
                    selectedItems.push(item.id);
                    totalCost += item.price;
                    // åªæœ‰éå±…å®¶å„²å‚™é¡çš„ç‰©å“æ‰è¨ˆç®—è² é‡
                    if (item.category !== 'home') {
                        totalWeight += item.weight;
                    }
                    budget -= item.price;
                }
            }
            
            updateUI();
            renderItems();
        }

        // æ›´æ–° UI
        function updateUI() {
            document.getElementById('budget').textContent = `$${budget}`;
            document.getElementById('total-cost').textContent = `$${totalCost}`;
            
            // é‡æ–°è¨ˆç®—ç¸½è² é‡ï¼ˆæ’é™¤å±…å®¶å„²å‚™é¡ï¼‰
            const currentWeight = selectedItems.reduce((sum, id) => {
                const item = items.find(i => i.id === id);
                return sum + (item && item.category !== 'home' ? item.weight : 0);
            }, 0);
            totalWeight = currentWeight;
            
            document.getElementById('total-weight').textContent = totalWeight.toFixed(1);
            
            // è² é‡è­¦å‘Šï¼ˆè¶…é15kgæœƒå½±éŸ¿ç§»å‹•é€Ÿåº¦ï¼Œåªè¨ˆç®—éš¨èº«é¡å’Œèº«åˆ†è­‰ä»¶ï¼‰
            const weightWarning = document.getElementById('weight-warning');
            if (totalWeight > 15) {
                weightWarning.classList.remove('hidden');
                document.getElementById('total-weight').classList.add('text-red-400');
            } else {
                weightWarning.classList.add('hidden');
                document.getElementById('total-weight').classList.remove('text-red-400');
            }
            
            const backpackList = document.getElementById('backpack-list');
            if (selectedItems.length === 0) {
                backpackList.innerHTML = '<p class="text-gray-400 italic">å°šæœªé¸æ“‡ä»»ä½•ç‰©å“</p>';
            } else {
                // æŒ‰åˆ†é¡é¡¯ç¤º
                const portableItems = selectedItems.filter(id => {
                    const item = items.find(i => i.id === id);
                    return item && item.category === 'portable';
                });
                const documentItems = selectedItems.filter(id => {
                    const item = items.find(i => i.id === id);
                    return item && item.category === 'document';
                });
                const homeItems = selectedItems.filter(id => {
                    const item = items.find(i => i.id === id);
                    return item && item.category === 'home';
                });
                
                let html = '';
                if (portableItems.length > 0) {
                    html += '<div class="mb-3"><span class="text-yellow-400 font-semibold">ğŸŸ¡ éš¨èº«é¡ï¼š</span>';
                    html += portableItems.map(itemId => {
                        const item = items.find(i => i.id === itemId);
                        return `<span class="bg-gray-700 rounded px-2 py-1 mr-2 mb-2 inline-block">${item.name} (${item.weight}kg)</span>`;
                    }).join('');
                    html += '</div>';
                }
                if (documentItems.length > 0) {
                    html += '<div class="mb-3"><span class="text-green-400 font-semibold">ğŸŸ¢ èº«åˆ†è­‰ä»¶ï¼š</span>';
                    html += documentItems.map(itemId => {
                        const item = items.find(i => i.id === itemId);
                        return `<span class="bg-gray-700 rounded px-2 py-1 mr-2 mb-2 inline-block">${item.name} (${item.weight}kg)</span>`;
                    }).join('');
                    html += '</div>';
                }
                if (homeItems.length > 0) {
                    html += '<div class="mb-3"><span class="text-red-400 font-semibold">ğŸ”´ å±…å®¶å„²å‚™é¡ï¼š</span>';
                    html += homeItems.map(itemId => {
                        const item = items.find(i => i.id === itemId);
                        return `<span class="bg-gray-700 rounded px-2 py-1 mr-2 mb-2 inline-block">${item.name} (${item.weight}kg)</span>`;
                    }).join('');
                    html += '</div>';
                }
                backpackList.innerHTML = html;
            }
            
            // æ›´æ–°æŒ‰éˆ•ç‹€æ…‹
            document.getElementById('start-btn').disabled = selectedItems.length === 0;
        }

        // é–‹å§‹ç¬¬äºŒéšæ®µ
        function startPhase2() {
            document.getElementById('phase1').classList.add('hidden');
            document.getElementById('phase2').classList.remove('hidden');
            
            runSurvivalChecks();
        }

        // åŸ·è¡Œç”Ÿå­˜åˆ¤å®š
        function runSurvivalChecks() {
            const checksDiv = document.getElementById('survival-checks');
            checksDiv.innerHTML = '';
            
            let survivalDays = 7; // åŸºç¤ç”Ÿå­˜å¤©æ•¸
            const messages = [];
            
            // è¨ˆç®—è² é‡å½±éŸ¿ï¼ˆåªè¨ˆç®—éš¨èº«é¡å’Œèº«åˆ†è­‰ä»¶ï¼Œæ’é™¤å±…å®¶å„²å‚™é¡ï¼‰
            const portableWeight = selectedItems.reduce((sum, id) => {
                const item = items.find(i => i.id === id);
                return sum + (item && item.category !== 'home' ? item.weight : 0);
            }, 0);
            
            if (portableWeight > 15) {
                messages.push({
                    type: 'danger',
                    text: `ä½ èƒŒè² äº† ${portableWeight.toFixed(1)}kg çš„éš¨èº«ç‰©å“ï¼Œè² é‡éé«˜å°è‡´ç§»å‹•é€Ÿåº¦å¤§å¹…ä¸‹é™ï¼Œåœ¨é€ƒé›£éç¨‹ä¸­æ¶ˆè€—äº†éå¤šé«”åŠ›ã€‚`,
                    phase: 0
                });
                survivalDays -= 2;
            }
            
            // æª¢æŸ¥å±…å®¶å„²å‚™é¡ç‰©å“ï¼ˆå¦‚æœå®Œå…¨æ²’æœ‰ï¼Œç”Ÿå­˜å¤©æ•¸å¾7å¤©æ‰åˆ°2å¤©ï¼Œæ’é™¤ç„¡é—œç·Šè¦çš„ç‰©å“ï¼‰
            const homeItems = selectedItems.filter(id => {
                const item = items.find(i => i.id === id);
                return item && item.category === 'home' && !item.isUseless;
            });
            if (homeItems.length === 0) {
                messages.push({
                    type: 'danger',
                    text: 'ä½ å®Œå…¨æ²’æœ‰æº–å‚™å±…å®¶å„²å‚™é¡ç‰©å“ï¼Œåœ¨é¿é›£æ‰€ä¸­ç¼ºä¹åŸºæœ¬ç”Ÿæ´»ç‰©è³‡ï¼Œç”Ÿå­˜è®Šå¾—æ¥µå…¶å›°é›£ã€‚',
                    phase: 0
                });
                survivalDays = 2; // å¾7å¤©æ‰åˆ°2å¤©
            }
            
            // ========== ç¬¬ä¸€éšæ®µï¼šç·Šæ€¥é¿é›£éšæ®µï¼ˆå‰24å°æ™‚ï¼Œéš¨èº«é¡ç‰©å“æ±ºå®šå­˜æ´»ç‡ï¼‰ ==========
            const phase1Div = document.createElement('div');
            phase1Div.className = 'bg-red-900/30 rounded-lg p-4 mb-4 border border-red-700';
            phase1Div.innerHTML = '<h3 class="text-xl font-bold text-red-400 mb-3">ğŸ”´ ç·Šæ€¥é¿é›£éšæ®µï¼ˆå‰24å°æ™‚ï¼Œéš¨èº«é¡ç‰©å“æ±ºå®šå­˜æ´»ç‡ï¼‰</h3>';
            checksDiv.appendChild(phase1Div);
            
            // æª¢æŸ¥éš¨èº«é¡ç‰©å“æ˜¯å¦è¶³å¤ ï¼ˆæ±ºå®šå‰24å°æ™‚å­˜æ´»ç‡ï¼Œæ’é™¤ç„¡é—œç·Šè¦çš„ç‰©å“ï¼‰
            const portableItems = selectedItems.filter(id => {
                const item = items.find(i => i.id === id);
                return item && item.category === 'portable' && !item.isUseless;
            });
            
            if (portableItems.length < 3) {
                messages.push({
                    type: 'danger',
                    text: 'ä½ çš„éš¨èº«é¡ç‰©å“æº–å‚™ä¸è¶³ï¼Œåœ¨ç½é›£ç™¼ç”Ÿå¾Œçš„å‰24å°æ™‚å…§é¢è‡¨æ¥µå¤§å±éšªã€‚',
                    phase: 1
                });
                survivalDays -= 3;
            }
            
            // æª¢æŸ¥é ­ç›”/é ­ç‡ˆ
            const hasHelmet = selectedItems.includes('helmet');
            const hasHeadlamp = selectedItems.includes('headlamp');
            if (!hasHelmet && !hasHeadlamp) {
                messages.push({
                    type: 'danger',
                    text: 'åœ°éœ‡å¾Œåœé›»ä¸”æœ‰æ‰è½ç‰©ï¼Œä½ åœ¨é»‘æš—ä¸­æ‘¸ç´¢æ™‚è¢«ç ¸å‚·ï¼Œè¡Œå‹•åŠ›ä¸‹é™ã€‚',
                    phase: 1
                });
                survivalDays -= 2;
            } else {
                messages.push({
                    type: 'success',
                    text: hasHelmet ? 'é ­ç›”ä¿è­·äº†ä½ çš„é ­éƒ¨ï¼Œé ­ç‡ˆè®“ä½ åœ¨é»‘æš—ä¸­å®‰å…¨ç§»å‹•ã€‚' : 'é ­ç‡ˆè®“ä½ åœ¨é»‘æš—ä¸­ä¿æŒè¦–é‡ï¼Œå®‰å…¨é€ƒé›¢å±éšªå€åŸŸã€‚',
                    phase: 1
                });
            }
            
            // æª¢æŸ¥å“¨å­
            if (!selectedItems.includes('whistle')) {
                messages.push({
                    type: 'danger',
                    text: 'ä½ å—å›°åœ¨å€’å¡Œçš„è²¨æ¶ä¸‹ï¼Œå¤§è²å‘¼å–Šå»æ²’äººè½è¦‹ï¼Œç™½ç™½è€—è²»é«”åŠ›ã€‚',
                    phase: 1
                });
                survivalDays -= 1;
            } else {
                messages.push({
                    type: 'success',
                    text: 'æ•‘é›£å“¨çš„è²éŸ³ç©¿é€å»¢å¢Ÿï¼Œæ•‘æ´äººå“¡è¿…é€Ÿæ‰¾åˆ°ä½ çš„ä½ç½®ã€‚',
                    phase: 1
                });
            }
            
            // æª¢æŸ¥è¡Œå‹•é›»æº
            if (!selectedItems.includes('powerbank')) {
                messages.push({
                    type: 'danger',
                    text: 'æ‰‹æ©Ÿæ²’é›»äº†ï¼Œä½ ç„¡æ³•æ¥æ”¶é˜²ç½è­¦å ±ï¼Œä¹Ÿç„¡æ³•è¯ç¹«å®¶äººã€‚',
                    phase: 1
                });
                survivalDays -= 1;
            } else {
                messages.push({
                    type: 'success',
                    text: 'è¡Œå‹•é›»æºè®“ä½ çš„æ‰‹æ©Ÿä¿æŒé‹ä½œï¼ŒåŠæ™‚æ”¶åˆ°é‡è¦è³‡è¨Šä¸¦è¯ç¹«å®¶äººã€‚',
                    phase: 1
                });
            }
            
            // æª¢æŸ¥æ”œå¸¶å¼å»æ‰€
            if (!selectedItems.includes('portable_toilet')) {
                messages.push({
                    type: 'danger',
                    text: 'é¿é›£æ‰€å»æ‰€å¤§æ’é•·é¾ä¸”è¡›ç”Ÿæƒ¡åŠ£ï¼Œä½ æ†‹å°¿å°è‡´èº«é«”ä¸é©ã€‚',
                    phase: 1
                });
                survivalDays -= 1;
            } else {
                messages.push({
                    type: 'success',
                    text: 'æ”œå¸¶å¼å»æ‰€è®“ä½ åœ¨é¿é›£æ‰€ä¿æŒåŸºæœ¬è¡›ç”Ÿï¼Œé¿å…æ„ŸæŸ“é¢¨éšªã€‚',
                    phase: 1
                });
            }
            
            // æª¢æŸ¥æ°´ï¼ˆ500mlï¼‰æˆ–ç”Ÿå‘½å¸ç®¡
            const hasWater = selectedItems.includes('water_500ml') || selectedItems.includes('foldable_water_bag');
            const hasLifeStraw = selectedItems.includes('life_straw');
            if (!hasWater && !hasLifeStraw) {
                messages.push({
                    type: 'danger',
                    text: 'é€ƒé›£è·¯ç¨‹ä¸­æ„Ÿåˆ°æ¥µåº¦ä¹¾æ¸´ï¼Œä½ çš„å°ˆæ³¨åŠ›é–‹å§‹æ¸™æ•£ã€‚',
                    phase: 1
                });
                survivalDays -= 2;
            } else {
                if (hasLifeStraw) {
                    messages.push({
                        type: 'success',
                        text: 'ç”Ÿå‘½å¸ç®¡è®“ä½ èƒ½å¾å„ç¨®æ°´æºç²å–ä¹¾æ·¨çš„é£²ç”¨æ°´ï¼Œå¤§å¤§æå‡äº†ç”Ÿå­˜èƒ½åŠ›ã€‚',
                        phase: 1
                    });
                    survivalDays += 1;
                } else {
                    messages.push({
                        type: 'success',
                        text: 'å……è¶³çš„æ°´åˆ†è®“ä½ åœ¨é€ƒé›£éç¨‹ä¸­ä¿æŒæ¸…é†’å’Œé«”åŠ›ã€‚',
                        phase: 1
                    });
                }
            }
            
            // æª¢æŸ¥æˆ°å‚™ä¹¾ç³§
            if (selectedItems.includes('emergency_rations')) {
                messages.push({
                    type: 'success',
                    text: 'æˆ°å‚™ä¹¾ç³§æä¾›äº†ç·Šæ€¥æ™‚æœŸçš„èƒ½é‡è£œå……ï¼Œè®“ä½ åœ¨å‰24å°æ™‚ä¿æŒé«”åŠ›ã€‚',
                    phase: 1
                });
                survivalDays += 1;
            }
            
            // æª¢æŸ¥æ”¶éŸ³æ©Ÿ
            if (selectedItems.includes('radio')) {
                messages.push({
                    type: 'success',
                    text: 'æ”¶éŸ³æ©Ÿè®“ä½ åŠæ™‚æ¥æ”¶ç½æƒ…è³‡è¨Šå’Œæ”¿åºœå…¬å‘Šï¼ŒæŒæ¡æ•‘æ´æ™‚æ©Ÿã€‚',
                    phase: 1
                });
                survivalDays += 1;
            }
            
            // æª¢æŸ¥å°è¬›æ©Ÿ
            if (selectedItems.includes('walkie_talkie')) {
                messages.push({
                    type: 'info',
                    text: 'å°è¬›æ©Ÿè®“ä½ èƒ½èˆ‡åŒè¡Œè€…ä¿æŒè¯ç¹«ï¼Œåœ¨æ··äº‚ä¸­ä¸æœƒèµ°æ•£ã€‚',
                    phase: 1
                });
            }
            
            // æª¢æŸ¥æ‰‹å¥—
            if (selectedItems.includes('gloves')) {
                messages.push({
                    type: 'success',
                    text: 'å·¥ä½œæ‰‹å¥—ä¿è­·ä½ çš„é›™æ‰‹ï¼Œåœ¨æ¸…ç†å»¢å¢Ÿæ™‚é¿å…å—å‚·ã€‚',
                    phase: 1
                });
            }
            
            // æª¢æŸ¥é‹ç®”é¿é›£æ¯¯
            if (selectedItems.includes('emergency_blanket')) {
                messages.push({
                    type: 'success',
                    text: 'é‹ç®”é¿é›£æ¯¯å¹«åŠ©ä½ ä¿æŒé«”æº«ï¼Œåœ¨å¯’å†·ç’°å¢ƒä¸­é¿å…å¤±æº«ã€‚',
                    phase: 1
                });
                survivalDays += 1;
            }
            
            // æª¢æŸ¥æš–æš–åŒ…
            if (selectedItems.includes('hand_warmers')) {
                messages.push({
                    type: 'info',
                    text: 'æš–æš–åŒ…åœ¨å¯’å†·å¤œæ™šæä¾›äº†é¡å¤–çš„æº«æš–ã€‚',
                    phase: 2
                });
            }
            
            // æª¢æŸ¥æ·¨æ°´éŒ 
            if (selectedItems.includes('water_purification')) {
                messages.push({
                    type: 'success',
                    text: 'æ·¨æ°´éŒ è®“ä½ èƒ½è™•ç†ä¸ä¹¾æ·¨çš„æ°´æºï¼Œå¢åŠ äº†é£²æ°´é¸æ“‡ã€‚',
                    phase: 1
                });
            }
            
            // æª¢æŸ¥æ­¢è¡€å¸¶
            if (selectedItems.includes('tourniquet')) {
                messages.push({
                    type: 'success',
                    text: 'æ­¢è¡€å¸¶åœ¨åš´é‡å¤–å‚·æ™‚èƒ½å¿«é€Ÿæ­¢è¡€ï¼Œå¯èƒ½æ•‘äº†ä½ çš„å‘½ã€‚',
                    phase: 1
                });
                survivalDays += 2;
            }
            
            // æª¢æŸ¥è—¥å“
            const hasMedicine = selectedItems.includes('pain_reliever') || 
                               selectedItems.includes('stomach_med') || 
                               selectedItems.includes('cold_med') ||
                               selectedItems.includes('anxiety_med');
            if (hasMedicine) {
                messages.push({
                    type: 'success',
                    text: 'æº–å‚™çš„è—¥å“å¹«åŠ©ä½ è™•ç†äº†å„ç¨®çªç™¼çš„å¥åº·å•é¡Œï¼Œé¿å…äº†ç—…æƒ…æƒ¡åŒ–ã€‚',
                    phase: 2
                });
                survivalDays += 1;
            }
            
            // æª¢æŸ¥è¡›ç”Ÿç”¨å“
            if (selectedItems.includes('toilet_paper') || selectedItems.includes('sanitary_pads')) {
                messages.push({
                    type: 'info',
                    text: 'è¡›ç”Ÿç”¨å“è®“ä½ åœ¨é¿é›£æ‰€ä¸­ä¿æŒåŸºæœ¬è¡›ç”Ÿã€‚',
                    phase: 2
                });
            }
            
            // ========== ç¬¬äºŒéšæ®µï¼šé¿é›£ç”Ÿæ´»éšæ®µï¼ˆå—å›° 3~7 å¤©ï¼Œå±…å®¶å„²å‚™é¡æ±ºå®šèˆ’é©åº¦ï¼‰ ==========
            const phase2Div = document.createElement('div');
            phase2Div.className = 'bg-blue-900/30 rounded-lg p-4 mb-4 border border-blue-700';
            phase2Div.innerHTML = '<h3 class="text-xl font-bold text-blue-400 mb-3 mt-4">ğŸŸ¢ é¿é›£ç”Ÿæ´»éšæ®µï¼ˆå—å›° 3~7 å¤©ï¼Œå±…å®¶å„²å‚™é¡æ±ºå®šèˆ’é©åº¦ï¼‰</h3>';
            checksDiv.appendChild(phase2Div);
            
            // æª¢æŸ¥é•·æœŸä¿å­˜é£Ÿå“ï¼ˆå±…å®¶å„²å‚™é¡ï¼‰
            if (!selectedItems.includes('longterm_food')) {
                messages.push({
                    type: 'danger',
                    text: 'ä¾¿åˆ©å•†åº—è¢«æ¶è³¼ä¸€ç©ºï¼Œä½ åªèƒ½ä¾é å¾®è–„çš„æ”¿åºœç™¼æ”¾ç³§é£Ÿç¶­ç”Ÿï¼Œæ’ä¸åˆ°ä¸€é€±ã€‚',
                    phase: 2
                });
                survivalDays -= 3;
            } else {
                messages.push({
                    type: 'success',
                    text: 'å……è¶³çš„é•·æœŸä¿å­˜é£Ÿå“è®“ä½ åº¦éäº†æœ€å›°é›£çš„æ™‚æœŸï¼Œé«”åŠ›å¾—ä»¥ç¶­æŒã€‚',
                    phase: 2
                });
                survivalDays += 2;
            }
            
            // æª¢æŸ¥å¡å¼çˆ/ç“¦æ–¯ç½
            const hasStove = selectedItems.includes('gas_stove');
            const hasCanister = selectedItems.includes('gas_canister');
            if (!hasStove || !hasCanister) {
                messages.push({
                    type: 'danger',
                    text: 'ç„¡æ³•åŠ ç†±é£Ÿç‰©ï¼Œå¯’å†·çš„å¤œè£¡ä½ åªèƒ½åƒå†·å†°å†°çš„ç½é ­ï¼Œå¿ƒæƒ…è®Šå¾—éå¸¸æ²®å–ªã€‚',
                    phase: 2
                });
                survivalDays -= 2;
            } else {
                messages.push({
                    type: 'success',
                    text: 'å¡å¼çˆè®“ä½ åƒåˆ°ç†±é¨°é¨°çš„é£Ÿç‰©ï¼Œåœ¨å¯’å†·çš„é¿é›£æ‰€ä¸­ç¶­æŒäº†æº«æš–ã€‚',
                    phase: 2
                });
                survivalDays += 1;
            }
            
            // æª¢æŸ¥æ¿•ç´™å·¾/æ¼±å£æ°´
            const hasWetWipes = selectedItems.includes('wet_wipes');
            const hasMouthwash = selectedItems.includes('mouthwash');
            if (!hasWetWipes && !hasMouthwash) {
                messages.push({
                    type: 'danger',
                    text: 'ç¼ºæ°´ç„¡æ³•æ´—æ¾¡åˆ·ç‰™ï¼Œä½ æ„Ÿåˆ°æ¸¾èº«é»è†©ï¼Œç”šè‡³é–‹å§‹å‡ºç¾çš®è†šéæ•ã€‚',
                    phase: 2
                });
                survivalDays -= 1;
            } else {
                messages.push({
                    type: 'success',
                    text: 'æ¿•ç´™å·¾å’Œæ¼±å£æ°´è®“ä½ åœ¨ç¼ºæ°´ç’°å¢ƒä¸­ä¿æŒåŸºæœ¬æ¸…æ½”ï¼Œé¿å…å¥åº·å•é¡Œã€‚',
                    phase: 2
                });
            }
            
            // æª¢æŸ¥çœ¼ç½©/è€³å¡
            const hasEyeMask = selectedItems.includes('eye_mask');
            const hasEarplugs = selectedItems.includes('earplugs');
            if (!hasEyeMask && !hasEarplugs) {
                messages.push({
                    type: 'danger',
                    text: 'é¿é›£æ‰€äººè²é¼æ²¸ã€ç‡ˆç«é€šæ˜ï¼Œä½ é€£çºŒå¹¾æ™šå¤±çœ ï¼Œé«”åŠ›é€æ”¯ã€‚',
                    phase: 2
                });
                survivalDays -= 2;
            } else {
                messages.push({
                    type: 'success',
                    text: 'çœ¼ç½©å’Œè€³å¡è®“ä½ åœ¨åµé›œçš„é¿é›£æ‰€ä¸­ç²å¾—ä¼‘æ¯ï¼Œæ¢å¾©é«”åŠ›ã€‚',
                    phase: 2
                });
                survivalDays += 1;
            }
            
            // æª¢æŸ¥å…¶ä»–æœ‰ç”¨ç‰©å“
            if (selectedItems.includes('firstaid')) {
                messages.push({
                    type: 'success',
                    text: 'æ€¥æ•‘ç”¨å“å¹«åŠ©ä½ è™•ç†äº†æ„å¤–å‚·å£ï¼Œé¿å…äº†æ„ŸæŸ“ã€‚',
                    phase: 2
                });
                survivalDays += 1;
            }
            
            if (selectedItems.includes('raincoat')) {
                messages.push({
                    type: 'info',
                    text: 'é›¨è¡£è®“ä½ åœ¨æƒ¡åŠ£å¤©æ°£ä¸­ä¿æŒä¹¾ç‡¥ã€‚',
                    phase: 2
                });
            }
            
            // æª¢æŸ¥ç„¡é—œç·Šè¦çš„ç‰©å“ï¼ˆæµªè²»é ç®—å’Œè² é‡ï¼Œåªè¨ˆç®—éš¨èº«é¡çš„è² é‡ï¼‰
            const uselessItems = selectedItems.filter(id => {
                const item = items.find(i => i.id === id);
                return item && item.isUseless === true;
            });
            if (uselessItems.length > 0) {
                const uselessCost = uselessItems.reduce((sum, id) => {
                    const item = items.find(i => i.id === id);
                    return sum + (item ? item.price : 0);
                }, 0);
                const uselessWeight = uselessItems.reduce((sum, id) => {
                    const item = items.find(i => i.id === id);
                    // åªè¨ˆç®—éå±…å®¶å„²å‚™é¡çš„è² é‡
                    return sum + (item && item.category !== 'home' ? item.weight : 0);
                }, 0);
                
                if (uselessWeight > 0) {
                    messages.push({
                        type: 'warning',
                        text: `ä½ å¸¶äº†ä¸€äº›ç„¡é—œç·Šè¦çš„ç‰©å“ï¼ˆå¦‚è£é£¾å“ã€å¨›æ¨‚ç”¨å“ç­‰ï¼‰ï¼Œæµªè²»äº† $${uselessCost} çš„é ç®—å’Œ ${uselessWeight.toFixed(1)}kg çš„è² é‡ï¼Œé€™äº›ç‰©å“åœ¨ç½é›£ä¸­æ¯«ç„¡ç”¨è™•ã€‚`,
                        phase: 2
                    });
                } else {
                    messages.push({
                        type: 'warning',
                        text: `ä½ å¸¶äº†ä¸€äº›ç„¡é—œç·Šè¦çš„ç‰©å“ï¼ˆå¦‚è£é£¾å“ã€å¨›æ¨‚ç”¨å“ç­‰ï¼‰ï¼Œæµªè²»äº† $${uselessCost} çš„é ç®—ï¼Œé€™äº›ç‰©å“åœ¨ç½é›£ä¸­æ¯«ç„¡ç”¨è™•ã€‚`,
                        phase: 2
                    });
                }
            }
             
            // ç¢ºä¿ç”Ÿå­˜å¤©æ•¸åœ¨åˆç†ç¯„åœå…§
            survivalDays = Math.max(1, Math.min(14, survivalDays));
            
            // å‰µå»ºåˆå§‹éšæ®µå®¹å™¨ï¼ˆç”¨æ–¼è² é‡å’Œå±…å®¶å„²å‚™é¡æª¢æŸ¥ï¼‰
            const phase0Div = document.createElement('div');
            phase0Div.className = 'bg-orange-900/30 rounded-lg p-4 mb-4 border border-orange-700';
            phase0Div.innerHTML = '<h3 class="text-xl font-bold text-orange-400 mb-3">âš ï¸ è² é‡èˆ‡æº–å‚™è©•ä¼°</h3>';
            checksDiv.appendChild(phase0Div);
            
            // é¡¯ç¤ºåˆ¤å®šçµæœ
            let messageIndex = 0;
            messages.forEach((msg) => {
                setTimeout(() => {
                    const msgDiv = document.createElement('div');
                    let bgColor = 'bg-gray-700';
                    if (msg.type === 'success') bgColor = 'bg-green-900/50';
                    if (msg.type === 'danger') bgColor = 'bg-red-900/50';
                    if (msg.type === 'warning') bgColor = 'bg-yellow-900/50';
                    if (msg.type === 'info') bgColor = 'bg-blue-900/50';
                    
                    msgDiv.className = `${bgColor} rounded-lg p-3 mb-2 fade-in border-l-4 ${
                        msg.type === 'success' ? 'border-green-400' :
                        msg.type === 'danger' ? 'border-red-400' :
                        msg.type === 'warning' ? 'border-yellow-400' : 'border-blue-400'
                    }`;
                    msgDiv.textContent = msg.text;
                    
                    // æ ¹æ“šéšæ®µæ·»åŠ åˆ°å°æ‡‰çš„å®¹å™¨
                    if (msg.phase === 0) {
                        phase0Div.appendChild(msgDiv);
                    } else if (msg.phase === 1) {
                        phase1Div.appendChild(msgDiv);
                    } else {
                        phase2Div.appendChild(msgDiv);
                    }
                    
                    messageIndex++;
                    // æœ€å¾Œä¸€æ¢è¨Šæ¯å¾Œé¡¯ç¤ºçµæœ
                    if (messageIndex === messages.length) {
                        setTimeout(() => {
                            showFinalResult(survivalDays);
                        }, 1000);
                    }
                }, messageIndex * 600);
            });
        }

        // é¡¯ç¤ºæœ€çµ‚çµæœ
        function showFinalResult(days) {
            const resultDiv = document.getElementById('final-result');
            resultDiv.classList.remove('hidden');
            
            let resultText = '';
            let resultColor = '';
            
            if (days >= 10) {
                resultText = 'å®Œç¾ç”Ÿå­˜ï¼ä½ æº–å‚™å……åˆ†ï¼ŒæˆåŠŸåº¦éäº†ç½é›£ï¼Œä¸¦ç²å¾—äº†å„ªå…ˆæ•‘æ´ã€‚';
                resultColor = 'text-green-400';
            } else if (days >= 7) {
                resultText = 'è‰¯å¥½è¡¨ç¾ï¼ä½ æˆåŠŸç”Ÿå­˜ä¸‹ä¾†ï¼Œé›–ç„¶éç¨‹è‰±è¾›ï¼Œä½†æœ€çµ‚ç­‰åˆ°äº†æ•‘æ´ã€‚';
                resultColor = 'text-yellow-400';
            } else if (days >= 4) {
                resultText = 'å‹‰å¼·ç”Ÿå­˜ã€‚ä½ æ´»äº†ä¸‹ä¾†ï¼Œä½†å› ç‚ºæº–å‚™ä¸è¶³è€Œä»˜å‡ºäº†å·¨å¤§ä»£åƒ¹ï¼Œèº«é«”ç‹€æ³ä¸ä½³ã€‚';
                resultColor = 'text-orange-400';
            } else {
                resultText = 'ç”Ÿå­˜å›°é›£ã€‚ä½ å‹‰å¼·æ´»äº†ä¸‹ä¾†ï¼Œä½†å› ç‚ºç¼ºä¹é—œéµç‰©è³‡ï¼Œæƒ…æ³éå¸¸å±æ€¥ï¼Œéœ€è¦ç·Šæ€¥é†«ç™‚å”åŠ©ã€‚';
                resultColor = 'text-red-400';
            }
            
            resultDiv.innerHTML = `
                <h2 class="text-2xl font-bold mb-4">æœ€çµ‚çµå±€</h2>
                <p class="text-lg mb-4">ä½ ç”Ÿå­˜äº† <span class="font-bold ${resultColor}">${days} å¤©</span></p>
                <p class="text-lg ${resultColor}">${resultText}</p>
            `;
            
            document.getElementById('replay-btn').classList.remove('hidden');
        }

        // é‡æ–°é–‹å§‹
        function replay() {
            budget = 4000;
            selectedItems = [];
            totalCost = 0;
            totalWeight = 0;
            
            document.getElementById('phase2').classList.add('hidden');
            document.getElementById('phase1').classList.remove('hidden');
            document.getElementById('survival-checks').innerHTML = '';
            document.getElementById('final-result').classList.add('hidden');
            document.getElementById('final-result').innerHTML = '';
            document.getElementById('replay-btn').classList.add('hidden');
            
            updateUI();
            renderItems();
        }

        // å•Ÿå‹•éŠæˆ²
        init();
    </script>
</body>
</html>

